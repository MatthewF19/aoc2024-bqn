#in←'0'-˜"8901012378121874874309659654987445678903320190120132980110456732"
in←'0'-˜∾•Flines "day10.txt"

l←√≠in
in↩l‿l⥊in⋈¨(↕≠in)
l10←l+10
pin ← {(l10⥊⟨¯1‿¯1⟩)∾𝕩∾(l10⥊⟨¯1‿¯1⟩)}⍟5{(5⥊⟨¯1‿¯1⟩)∾𝕩∾(5⥊⟨¯1‿¯1⟩)}⎉1 in
•Show hs←((⌊÷⟜l10)∾l10⊸|)¨/⥊0=⊑⚇1 pin
s ← 9

•Show +´≠∘⍷¨⊢˝∘(∘‿2⊸⥊)⚇1⟨⟩⊸≢¨⊸/¨<˘∾¨>((1+↕s)⊸≡¨⊑⚇1)⊸(/⚇0‿1○<˘)⥊˘<˘⚇1 s‿2⥊⚇1{𝕩∾¨⎉0‿1𝕨}´⌽⍉⁼¨(<hs)⊑⎉1‿2¨((«˘≍»˘)∾(«≍»))⎉2⍟(1+↕s) pin